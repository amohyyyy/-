<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>منصة مكسرات التعليمية</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: 'Cairo', sans-serif; background:#f9f5f0; margin:0; padding:0; }
    header { background:#6b4226; color:#fff; padding:15px; text-align:center; }
    nav a { color:white; margin:0 15px; text-decoration:none; }
    section { padding:40px; text-align:center; }
    input, button { padding:10px; margin:5px; border-radius:8px; border:1px solid #ccc; }
    button { background:#6b4226; color:#fff; cursor:pointer; }
    button:hover { background:#8c5a39; }
    .hidden { display:none; }
    .card { background:#fff; padding:20px; margin:20px auto; max-width:500px; border-radius:15px; box-shadow:0 4px 10px rgba(0,0,0,0.1); }
  </style>
</head>
<body>
  <header>
    <h1>🌰 منصة مكسرات التعليمية</h1>
    <nav>
      <a href="#" onclick="showSection('home')">الرئيسية</a>
      <a href="#" onclick="showSection('courses')">الكورسات</a>
      <a href="#" onclick="showSection('auth')">تسجيل الدخول</a>
      <a href="#" onclick="showSection('admin')">لوحة التحكم</a>
    </nav>
  </header>

  <!-- الرئيسية -->
  <section id="home" class="card">
    <h2>أهلاً بك 👋</h2>
    <p>منصة تعليمية لنشر الكورسات والاختبارات التفاعلية.</p>
  </section>

  <!-- الكورسات -->
  <section id="courses" class="card hidden">
    <h2>📚 الكورسات</h2>
    <div id="coursesList">جارِ التحميل...</div>
  </section>

  <!-- تسجيل / دخول -->
  <section id="auth" class="card hidden">
    <h2>🔑 تسجيل / دخول</h2>
    <input type="email" id="email" placeholder="البريد الإلكتروني"><br>
    <input type="password" id="password" placeholder="كلمة المرور"><br>
    <button onclick="login()">تسجيل دخول</button>
    <button onclick="signup()">تسجيل جديد</button>
    <p id="authMsg"></p>
  </section>

  <!-- لوحة تحكم الأدمن -->
  <section id="admin" class="card hidden">
    <h2>⚙️ لوحة التحكم</h2>
    <p>إضافة كورسات جديدة</p>
    <input type="text" id="courseTitle" placeholder="عنوان الكورس"><br>
    <textarea id="courseDesc" placeholder="وصف الكورس"></textarea><br>
    <button onclick="addCourse()">إضافة الكورس</button>
    <div id="adminMsg"></div>
  </section>

  <!-- Firebase & سكريبت -->
  <script type="module">
    // تهيئة Firebase
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-app.js";
    import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword } 
      from "https://www.gstatic.com/firebasejs/10.13.0/firebase-auth.js";
    import { getFirestore, collection, addDoc, getDocs } 
      from "https://www.gstatic.com/firebasejs/10.13.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBvBlbWmFxN1t0Sv0TkWfcYndvgzq6499Y",
      authDomain: "edu-platform-35476.firebaseapp.com",
      projectId: "edu-platform-35476",
      storageBucket: "edu-platform-35476.firebasestorage.app",
      messagingSenderId: "823570222456",
      appId: "1:823570222456:web:656afb19407d955448cc8d",
      measurementId: "G-V7DZRJR57F"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // إظهار/إخفاء أقسام
    window.showSection = function(id) {
      document.querySelectorAll("section").forEach(s => s.classList.add("hidden"));
      document.getElementById(id).classList.remove("hidden");
    }

    // تسجيل جديد
    window.signup = function() {
      const email = document.getElementById("email").value;
      const pass = document.getElementById("password").value;
      createUserWithEmailAndPassword(auth, email, pass)
        .then(() => document.getElementById("authMsg").innerText = "✅ تم إنشاء الحساب")
        .catch(err => document.getElementById("authMsg").innerText = "❌ " + err.message);
    }

    // تسجيل دخول
    window.login = function() {
      const email = document.getElementById("email").value;
      const pass = document.getElementById("password").value;
      signInWithEmailAndPassword(auth, email, pass)
        .then(() => {
          document.getElementById("authMsg").innerText = "✅ تم تسجيل الدخول";
          showSection("courses");
          loadCourses();
        })
        .catch(err => document.getElementById("authMsg").innerText = "❌ " + err.message);
    }

    // إضافة كورس جديد
    window.addCourse = async function() {
      const title = document.getElementById("courseTitle").value;
      const desc = document.getElementById("courseDesc").value;
      try {
        await addDoc(collection(db, "courses"), { title, desc });
        document.getElementById("adminMsg").innerText = "✅ تم إضافة الكورس";
        loadCourses();
      } catch (err) {
        document.getElementById("adminMsg").innerText = "❌ " + err.message;
      }
    }

    // تحميل الكورسات
    async function loadCourses() {
      const list = document.getElementById("coursesList");
      list.innerHTML = "";
      const snapshot = await getDocs(collection(db, "courses"));
      snapshot.forEach(doc => {
        const c = doc.data();
        list.innerHTML += `<div class="card"><h3>${c.title}</h3><p>${c.desc}</p></div>`;
      });
    }
  </script>
</body>
</html>
